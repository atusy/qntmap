% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find-outlier.R
\name{find_outlier}
\alias{find_outlier}
\title{Find outliers caused by multi-phase pixels}
\usage{
find_outlier(epma, fine_phase, interval = c("prediction", "tukey"),
  method = c("rq", "lsfit", "median"), percentile = 0.99)
}
\arguments{
\item{epma}{A value returned by \code{tidy_epma()}}

\item{interval}{A type of the interval. Data points outside intervals are treated as outliers.
If \code{"prediction"`` (default), prediction intervals are used based on Poisson process. If }"tukey"``, conditional lower and upper whiskers are used where the lower is
$Q_{1/4} - 1.5 IQR$ and the upper is $Q_{3/4} + 1.5 IQR$.}

\item{method}{Applicable when \code{interval = "prediction"}.
If \code{"rq"} (default), quantile regression is performed (\code{quantreg::rq}).
If \code{"lsfit"}, least square regression is performed (\code{stats::lsfit}).}

\item{percentile}{A percentile of predictive interaval.
Applicable when \code{interval = "prediction"}.}
}
\description{
This function add to the data frame generated by \code{tidy_epma()} columns
\code{outlier} (boolean), \code{pkint.L_est}, \code{pkint.H_est}, \code{mapint.L_est}, and
\code{mapint.H_est}. Required columns in input are \code{elint}, \code{id}, \code{pk_t}, \code{beam}, \code{dwell}, \code{beam_map}, \code{pkint}, \code{pkint.L}, \code{pkint.H}, \code{mapint}, \code{mapint.L}, \code{mapint.H}.
}
\details{
When comparing data points of spot analysis and mapping analysis who share
the same coordinates, it is expected that they analyze the same phases.
However, this is unlikely when mapping analysis involves multi-phase pixels
due to sizes of pixels and phases. This function removes such multi-phase
pixels by finding outliers of mapping peak intensities.
}
