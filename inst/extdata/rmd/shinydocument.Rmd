---
runtime: shiny
output: 
  flexdashboard::flex_dashboard: default
  html_document: default
---

```{r, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# foo

## bar


### baz

```{r, eval = TRUE}
library(shinyWidgets)
picker_input <- function(
  inputId, label = NULL, choices,
  options = list(style = "form-control shiny-bound-input"),
  ...
) {
  pickerInput(
    inputId = inputId, label = label, choices = choices, 
    options = options, ...
  )
}

select_element_and_range <- function(
  id, choices, label = "Element", dropdown = NULL
) {
  ids <- paste0(id, "_", c("elem", "min", "max"))
  cssgrid::grid_layout(
    picker_input(
      ids[[1L]], label = label, choices = choices, selected = choices[[1L]],
      width = "100%"
    ),
    numericInput(ids[[2L]], "Min", value = NA_real_, width = "100%"),
    numericInput(ids[[3L]], "Max", value = NA_real_, width = "100%"),
    dropdown,
    cols = "1fr 1fr 1fr auto",
    column_gap = "5px",
    style = "width: 100%;"
  )
}

dropdown_map <- function(id, ...) {
  div(dropdown(
    picker_input(
      paste0(id, "_color"), label = "Color", 
      choices = c("viridis", "gray"), selected = "viridis"
    ),
    ...,
    circle = FALSE, right = TRUE, width = "auto"
  ), style = "align-self: end; margin-bottom: 15px;")
}
select_element_and_range("test", "test", dropdown = dropdown_map("xmap"))
```



































